<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - PixelGame</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page-wrapper">
    <header>
      <h1>Admin Panel</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="games.html">Games</a>
        <a href="profile.html">Profile</a>
        <a href="login.html">Login</a>
      </nav>
    </header>

    <main>
      <div class="section-box">
        <h2>Registered Users</h2>
        <div id="userList"></div>
      </div>
    </main>

    <footer>
      Â© 2025 PixelGame Admin Panel.
    </footer>
  </div>

  <script>
    const adminUsers = ["Nova"]; // Add more admin usernames here if needed
    const currentUser = localStorage.getItem("profileUsername");

    if (!adminUsers.includes(currentUser)) {
      alert("Access denied. You are not an admin.");
      window.location.href = "login.html";
    }

    function renderUsers() {
      const users = JSON.parse(localStorage.getItem("registeredUsers")) || [];
      const userData = JSON.parse(localStorage.getItem("userData")) || {};
      const container = document.getElementById("userList");

      if (users.length === 0) {
        container.innerHTML = "<p>No registered users yet.</p>";
        return;
      }

      let html = "<table border='1' cellspacing='0' cellpadding='8'><tr><th>Username</th><th>Bio</th><th>Password</th><th>Actions</th></tr>";

      users.forEach(username => {
        const user = userData[username];
        const bio = user?.bio || "No bio";
        const password = user?.password || "â€”";

        html += `
          <tr>
            <td>${username}</td>
            <td><input type="text" value="${bio}" id="bio-${username}"></td>
            <td><input type="text" value="${password}" id="pass-${username}"></td>
            <td>
              <button onclick="saveUser('${username}')">ðŸ’¾ Save</button>
              <button onclick="deleteUser('${username}')">ðŸ—‘ Delete</button>
            </td>
          </tr>
        `;
      });

      html += "</table>";
      container.innerHTML = html;
    }

    function saveUser(username) {
      const bio = document.getElementById(`bio-${username}`).value;
      const password = document.getElementById(`pass-${username}`).value;

      let userData = JSON.parse(localStorage.getItem("userData")) || {};
      if (!userData[username]) userData[username] = {};
      userData[username].bio = bio;
      userData[username].password = password;

      localStorage.setItem("userData", JSON.stringify(userData));
      alert(`Updated ${username}'s profile.`);
    }

    function deleteUser(username) {
      if (!confirm(`Are you sure you want to delete "${username}"?`)) return;

      let users = JSON.parse(localStorage.getItem("registeredUsers")) || [];
      let userData = JSON.parse(localStorage.getItem("userData")) || {};

      users = users.filter(user => user !== username);
      delete userData[username];

      localStorage.setItem("registeredUsers", JSON.stringify(users));
      localStorage.setItem("userData", JSON.stringify(userData));

      alert(`User "${username}" has been deleted.`);
      renderUsers();
    }

    document.addEventListener("DOMContentLoaded", renderUsers);
  </script>
</body>
</html>
