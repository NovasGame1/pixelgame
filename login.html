<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PixelGame - Login</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page-wrapper">
    <header>
      <h1>PixelGame</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="games.html">Games</a>
        <a href="profile.html">Profile</a>
        <a href="login.html" id="loginLink">Login</a>
        <a href="#" id="logoutLink" style="display: none;" onclick="logout()">Logout</a>
      </nav>
    </header>

    <main>
      <div class="section-box">
        <h2>Log In / Sign Up</h2>

        <form onsubmit="saveProfile(); return false;">
          <label for="username">Username:</label><br>
          <input type="text" id="username" placeholder="Enter your username" required><br><br>

          <label for="password">Password:</label><br>
          <input type="password" id="password" placeholder="Enter your password" required><br><br>

          <label for="bio">Bio:</label><br>
          <textarea id="bio" placeholder="Tell us about yourself..." rows="5" cols="40" required></textarea><br><br>

          <button type="submit">Log In / Sign Up</button>
        </form>
      </div>
    </main>

    <footer>
      © 2025 PixelGame.
    </footer>
  </div>

  <script>
    function saveProfile() {
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();
      const bio = document.getElementById('bio').value.trim();

      if (!username || !password || !bio) {
        alert('Please fill in all fields.');
        return;
      }

      let users = JSON.parse(localStorage.getItem('registeredUsers')) || [];
      let userData = JSON.parse(localStorage.getItem('userData')) || {};

      if (users.includes(username)) {
        // Existing user — verify password
        if (userData[username] && userData[username].password === password) {
          // Login successful
          localStorage.setItem('profileUsername', username);
          localStorage.setItem('profileBio', bio);
          alert('Welcome back, ' + username + '!');
          window.location.href = 'profile.html';
        } else {
          alert('Incorrect password for this username.');
        }
        return;
      }

      // New user — register
      users.push(username);
      localStorage.setItem('registeredUsers', JSON.stringify(users));

      userData[username] = {
        password: password,
        bio: bio
      };
      localStorage.setItem('userData', JSON.stringify(userData));

      localStorage.setItem('profileUsername', username);
      localStorage.setItem('profileBio', bio);

      alert('Account created!');
      window.location.href = 'profile.html';
    }

    function updateNavLinks() {
      const username = localStorage.getItem('profileUsername');
      const loginLink = document.getElementById('loginLink');
      const logoutLink = document.getElementById('logoutLink');

      if (username) {
        loginLink.style.display = 'none';
        logoutLink.style.display = 'inline';
      } else {
        loginLink.style.display = 'inline';
        logoutLink.style.display = 'none';
      }
    }

    function logout() {
      localStorage.removeItem('profileUsername');
      localStorage.removeItem('profileBio');
      updateNavLinks();
      window.location.href = 'login.html';
    }

    document.addEventListener('DOMContentLoaded', updateNavLinks);
  </script>
</body>
</html>
