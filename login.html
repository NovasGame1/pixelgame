<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PixelGame â€“ Login</title>
  <link rel="stylesheet" href="style.css">
  <!-- optional: your favicon etc -->
</head>
<body>
  <div class="page-wrapper">
    <header>
      <a href="index.html"><img src="assets/images/logo.png" alt="PixelGame" class="site-logo"></a>
    </header>

    <main>
      <h2>Log In</h2>
      <form id="loginForm">
        <div>
          <label for="username">Username</label><br>
          <input type="text" id="username" required>
        </div>
        <div>
          <label for="password">Password</label><br>
          <input type="password" id="password" required>
        </div>
        <button type="submit">Log In</button>
      </form>
    </main>

    <footer>Â© 2025 PixelGame.</footer>
  </div>

  <script>
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value;
      const userData = JSON.parse(localStorage.getItem("userData")) || {};

      // 1) User exists?
      if (!userData[username]) {
        alert("User not found.");
        return;
      }
      const user = userData[username];
      const now  = Date.now();

      // 2) Ban enforcement
      if (user.isBanned) {
        // auto-unban if expired
        if (user.banExpires && now > user.banExpires) {
          user.isBanned   = false;
          delete user.banReason;
          delete user.banExpires;
          localStorage.setItem("userData", JSON.stringify(userData));
        } else {
          let msg = "ðŸš« You are banned from PixelGame.";
          msg += "\n\nReason: " + (user.banReason || "No reason provided.");
          if (user.banExpires) {
            msg += "\n\nBan expires: " + new Date(user.banExpires).toLocaleString();
          } else {
            msg += "\n\nDuration: Permanent";
          }
          alert(msg);
          return;
        }
      }

      // 3) Password check
      if (user.password !== password) {
        alert("Incorrect password.");
        return;
      }

      // 4) Success: record lastLogin & forward to profile
      user.lastLogin = now;
      localStorage.setItem("userData", JSON.stringify(userData));
      localStorage.setItem("profileUsername", username);
      localStorage.setItem("profileBio", user.bio || "");
      window.location.href = "profile.html";
    });
  </script>
</body>
</html>
