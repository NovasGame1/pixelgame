<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PixelGame - Login</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page-wrapper">
    <header>
      <h1>PixelGame</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="games.html">Games</a>
        <a href="profile.html">Your Profile</a>
        <a href="people.html">People</a>
                <a href="shop.html">Shop</a>
        <a href="admin.html" id="adminBtn" style="display: none;">Admin Panel</a>
        <a href="login.html" id="loginLink">Login</a>
        <a href="#" id="logoutLink" style="display: none;" onclick="logout()">Logout</a>
      </nav>
    </header>

    <main>
      <div class="section-box">
        <h2>Log In / Sign Up</h2>

        <form onsubmit="saveProfile(); return false;">
          <label for="username">Username:</label><br>
          <input type="text" id="username" placeholder="Enter your username" required><br><br>

          <label for="password">Password:</label><br>
          <input type="password" id="password" placeholder="Enter your password" required><br><br>

          <button type="submit">Create Account / Log In</button>
        </form>

        <hr style="margin: 30px 0;">

        <button onclick="continueAsGuest()">Continue as Guest</button>
      </div>
    </main>

    <footer>
      Â© 2025 PixelGame.
    </footer>
  </div>

 <script>
  function saveProfile() {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value.trim();

    if (!username || !password) {
      alert('Please fill in all fields.');
      return;
    }

    let users = JSON.parse(localStorage.getItem('registeredUsers')) || [];
    let userData = JSON.parse(localStorage.getItem('userData')) || {};

if (users.includes(username)) {
  if (userData[username] && userData[username].password === password) {
    // ðŸ©¹ Patch old users with no Bits
    if (userData[username].bits === undefined) {
      userData[username].bits = 0;
      localStorage.setItem('userData', JSON.stringify(userData));
    }

    // Login success
    localStorage.setItem('profileUsername', username);
    localStorage.setItem('profileBio', userData[username].bio || '');
    alert('Welcome back, ' + username + '!');
    window.location.href = 'profile.html';
  } else {
    alert('Incorrect password for this username.');
  }
  return;
}


    // Create new account
    users.push(username);
    localStorage.setItem('registeredUsers', JSON.stringify(users));

    userData[username] = {
      password: password,
      bio: "This is your default bio. You can edit it later.",
      bits: 0 // ðŸ’° Starting bits
    };
    localStorage.setItem('userData', JSON.stringify(userData));

    localStorage.setItem('profileUsername', username);
    localStorage.setItem('profileBio', userData[username].bio);

    alert('Account created!');
    window.location.href = 'profile.html';
  }

  function continueAsGuest() {
    let guestCount = parseInt(localStorage.getItem('guestCount') || '0');
    let users = JSON.parse(localStorage.getItem('registeredUsers')) || [];

    let guestName;
    do {
      guestCount++;
      guestName = "Guest " + guestCount;
    } while (users.includes(guestName));

    localStorage.setItem('guestCount', guestCount);
    localStorage.setItem('profileUsername', guestName);
    localStorage.setItem('profileBio', "I'm playing as a guest!");

    alert("You're now playing as " + guestName);
    window.location.href = 'profile.html';
  }

  function updateNavLinks() {
    const username = localStorage.getItem('profileUsername');
    const isAdmin = username === "Nova";
    document.getElementById('loginLink').style.display = username ? 'none' : 'inline';
    document.getElementById('logoutLink').style.display = username ? 'inline' : 'none';
    const adminBtn = document.getElementById("adminBtn");
    if (adminBtn) adminBtn.style.display = isAdmin ? 'inline' : 'none';
  }

  function logout() {
    localStorage.removeItem('profileUsername');
    localStorage.removeItem('profileBio');
    updateNavLinks();
    window.location.href = 'login.html';
  }

  document.addEventListener('DOMContentLoaded', updateNavLinks);
</script>




  
</body>
</html>
